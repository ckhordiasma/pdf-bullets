{"version":3,"sources":["components/tools.js","components/bullets.js","static/abbrs.xlsx","components/abbrtable.js","components/abbrs.js","components/thesaurus.js","components/bulletapp.js","serviceWorker.js","index.js"],"names":["pdfjs","require","pdfjsWorker","GlobalWorkerOptions","workerSrc","ImportTools","props","importFile","e","fileInputRef","current","value","callback","file","console","log","state","type","getDataFromPDF","getDataFromJSON","files","inputClick","importType","setState","click","filedata","pdfSetup","arrayBuffer","then","buffer","uint8Array","Uint8Array","getDocument","data","promise","getXFA","pdf","getFormName","getMetadata","result","info","Custom","getAllData","Promise","all","pullBullets","results","formName","datasetXML","replace","xmlDoc","DOMParser","parseFromString","bulletText","Forms","tagName","querySelector","innerHTML","getPageInfo","templateXML","fonts","fontSizes","widths","i","bulletTag","getAttribute","getBulletsFromPdf","textUpdater","onTextUpdate","widthUpdater","onWidthUpdate","bulletsHTML","pageData","parseFloat","width","bullets","documentElement","textContent","reader","FileReader","onload","JSON","parse","target","onJSONImport","readAsText","hoverOut","hovering","toggleMenu","React","createRef","menuState","this","className","onChange","style","display","ref","onClick","aria-haspopup","aria-controls","icon","faAngleDown","id","role","onMouseLeave","href","PureComponent","OutputTools","widthAWD","widthEPR","widthOPR","min","max","step","onWidthChange","enableOptim","onOptimChange","InputTools","onTextNorm","SaveTools","onSave","settings","storedData","stringify","localStorage","setItem","length","err","name","alert","onExport","dataURI","encodeURIComponent","exportRef","download","Logo","ThesaurusTools","onHide","DocumentTools","aria-label","onThesaurusHide","getSelectionInfo","editorState","selectionState","getSelection","anchorKey","getAnchorKey","contentBlock","getCurrentContent","getBlockForKey","start","getStartOffset","end","getEndOffset","selectedText","getText","slice","renderBulletText","text","getWidth","match","error","fullWidth","trimEnd","textLines","lines","overflow","textSplit","split","answerIdx","join","recursedText","warn","recursedResult","avgCharWidth","guessIndex","parseInt","firstGuessWidth","substring","BULLET","sentence","BulletComparator","setEditorState","onSelect","abbrReplacer","bulletOutputID","useState","Map","heightMap","setHeightMap","useEffect","newHeightMap","getBlockMap","keys","key","blockDiv","document","set","getBoundingClientRect","height","newEditorState","handleKeyCommand","command","newState","RichUtils","onMouseUp","event","selection","window","toString","onKeyDown","ctrlKey","keyCode","preventDefault","RegExp","range","createRange","selectNode","removeAllRanges","addRange","tabIndex","Array","from","Bullet","widthPx","DPI","get","onHighlight","canvasRef","useRef","outputTextLines","setOutputTextLines","color","setColor","loading","setLoading","optimStatus","setOptimStatus","rendering","setBulletRendering","getTextWidth","txt","canvas","context","getContext","font","textAlign","measureText","optimResults","evalFcn","smallerSpace","largerSpace","optWords","initResults","prevResults","finalResults","newSpace","finalOptimStatus","hashCode","str","hash","charCodeAt","getRandomInt","seed","Math","floor","abs","worstCaseResults","status","iReplace","splice","newResults","optimize","visibility","position","top","left","minHeight","flexDirection","map","line","whiteSpace","GlobalFilter","preGlobalFilteredRows","globalFilter","setGlobalFilter","count","setValue","useAsyncDebounce","undefined","placeholder","fontSize","border","DefaultColumnFilter","column","filterValue","setFilter","BooleanFilter","options","useMemo","values","currentSelection","indexOf","SelectCheckbox","row","updateDataAfterInput","getToggleRowSelectedProps","onSelChange","rowSelectProps","indeterminate","useCallback","index","checked","mergedStyle","update","size","faCheckSquare","faSquare","EditableCellTemplate","initialValue","onBlur","Row","rowOps","cells","cell","getCellProps","render","appendRow","faCopy","deleteRow","faTrash","AbbrTable","setData","columns","Header","accessor","Cell","Filter","filter","disableSortBy","filterTypes","boolean","rows","rowValue","defaultColumn","beforeIndex","beforeRecord","$splice","tableInstance","useTable","rowIndex","columnId","oldData","$set","autoResetSelectedRows","manualRowSelectedKey","useFilters","useGlobalFilter","useSortBy","useRowSelect","getTableProps","getTableBodyProps","headerGroups","prepareRow","visibleColumns","colSpan","headerGroup","getHeaderGroupProps","headers","getHeaderProps","getSortByToggleProps","isSorted","isSortedDesc","canFilter","getRowProps","AbbrTools","getDataFromXLS","workbook","XLSX","read","raw","utils","sheet_to_json","Sheets","SheetNames","enabled","abbr","readAsBinaryString","wb","book_new","sht","json_to_sheet","book_append_sheet","writeFile","confirm","res","xhttp","XMLHttpRequest","responseType","response","open","SampleAbbrFile","send","AbbrsViewer","handleCardClick","word","This","onSelReplace","SynonymViewer","getSynonyms","phrase","onreadystatechange","readyState","dat","responseText","synonyms","item","hidden","prevProps","mainBody","replacedWord","otherAbbrs","abbrDict","header","onMouseDown","faPlus","explanation","noResults","SynonymList","Synonym","mainAbbrDisp","fontWeight","enabledAbbrDisp","disabledAbbrDisp","enabledAbbrs","fontStyle","disabled","disabledAbbrs","defaultAbbrData","defaultEditorState","EditorState","createWithContent","ContentState","createFromText","BulletApp","setEnableOptim","setWidth","abbrData","setAbbrData","setAbbrDict","setSelection","currentTab","setCurrentTab","showThesaurus","setShowThesaurus","handleJSONImport","settingsArray","isArray","fromJS","getItem","newAbbrDict","forEach","fullWord","String","push","finalAbbrDict","Object","abbrs","allApprovedAbbrs","string","regExp","p1","p2","p3","handleThesaurusHide","tabContents","newSel","trim","newWidth","selectionsToReplace","contentState","block","regex","matchArr","exec","findWithRegex","anchorOffset","focusOffset","SelectionState","createEmpty","merge","newContentState","reverse","Modifier","replaceText","newText","getPlainText","toJS","activeElement","trailingSpaces","newEnd","newSelectionState","newContent","newEditorStateSelect","forceSelection","tab","newTab","isLocalhost","Boolean","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","WebFont","load","custom","families","ReactDOM","getElementById","xh","DONE","Count","incrementVisitors","URL","process","origin","addEventListener","fetch","contentType","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.d72f19ce.chunk.js","sourcesContent":["import React from \"react\"\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faAngleDown } from \"@fortawesome/free-solid-svg-icons\"\n\nconst pdfjs = require('@ckhordiasma/pdfjs-dist');\nconst pdfjsWorker = require('@ckhordiasma/pdfjs-dist/build/pdf.worker.entry');\npdfjs.GlobalWorkerOptions.workerSrc = pdfjsWorker;\n\n//PDF import\nclass ImportTools extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.fileInputRef = React.createRef();\n        this.state = {\n            type: 'none',\n            hovering: false,\n        }\n    }\n\n    importFile = (e) => {\n        if (!this.fileInputRef.current.value) {\n            console.log('no file picked');\n            return;\n        } else {\n            let callback = (file) => { console.log(file) };\n            if (this.state.type === 'PDF') {\n                callback = this.getDataFromPDF;\n            } else if (this.state.type === 'JSON') {\n                callback = this.getDataFromJSON;\n            }\n            //return Promise.resolve(this.fileInputRef.current.files[0]).then(callback).then(() => {\n            //    this.fileInputRef.current.value = ''});\n            callback(this.fileInputRef.current.files[0]);\n            this.fileInputRef.current.value = '';\n        }\n    }\n    inputClick = (importType) => {\n        return () => {\n            this.setState({\n                type: importType,\n            });\n            this.fileInputRef.current.click();\n        };\n    }\n    getDataFromPDF = (file) => {\n        const { pullBullets, getPageInfo } = getBulletsFromPdf(file);\n        //note: these promises are PDFJS promises, not ES promises\n\n        //was not able to call this (this.props.onTextUpdate) inside the \"then\" scope, so I const'ed them out\n        const textUpdater = this.props.onTextUpdate;\n        const widthUpdater = this.props.onWidthUpdate;\n\n        Promise.all([pullBullets, getPageInfo]).then(([bulletsHTML, pageData]) => {\n            widthUpdater(parseFloat(pageData.width))();\n\n            // This is needed to convert the bullets HTML into normal text. It gets rid of things like &amp;\n            const bullets =\n                new DOMParser().parseFromString(bulletsHTML, 'text/html').documentElement.textContent;\n            textUpdater(bullets)();\n        });\n\n    }\n    getDataFromJSON = (file) => {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n\n            const data = JSON.parse(e.target.result);\n\n            this.props.onJSONImport(data);\n        };\n        reader.readAsText(file)\n    }\n\n    hoverOut = () => {\n        this.setState({ hovering: false });\n    }\n    toggleMenu = () => {\n        const current = this.state.hovering;\n        this.setState({ hovering: !current });\n    }\n    render() {\n        const menuState = this.state.hovering ? \"is-active\" : \"\";\n        return (\n            <div className={\"dropdown \" + menuState}>\n                <input type=\"file\" onChange={this.importFile} style={{ display: \"none\" }} ref={this.fileInputRef}></input>\n                <div className=\"dropdown-trigger\">\n                    <div className=\"buttons has-addons\">\n                        <button className=\"button\" onClick={this.inputClick('PDF')}>Import</button>\n                        <button className=\"button\" onClick={this.toggleMenu} aria-haspopup=\"true\" aria-controls=\"import-menu\" >\n                            <span className=\"icon\">\n\n                                <FontAwesomeIcon icon={faAngleDown} />\n                            </span>\n                        </button>\n                    </div>\n                </div>\n                <div className=\"dropdown-menu\" id=\"import-menu\" role=\"menu\" onMouseLeave={this.hoverOut}>\n                    <div className=\"dropdown-content\">\n                        <a href=\"?#\" className=\"dropdown-item\" onClick={this.inputClick('PDF')}>PDF</a>\n                        <a href=\"?#\" className=\"dropdown-item\" onClick={this.inputClick('JSON')}>JSON</a>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n// form width, space optimization, select text\nclass OutputTools extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.state = {\n\n        }\n    }\n    render() {\n        const widthAWD = 202.321;\n        const widthEPR = 202.321;\n        const widthOPR = 201.041;\n        return (\n            <div className=\"field is-grouped\">\n                {/* if I want to group things together in a field, each subelement must have the control class name */}\n                <div className=\"control field has-addons\">\n                    <div className=\"control has-icons-right\">\n                        <input className=\"input\" id=\"widthInput\" type='number' min=\"100\" max=\"500\" step=\".001\" value={this.props.width} onChange={this.props.onWidthChange}></input>\n                        <span className='icon is-right'>mm</span>\n                    </div>\n                    <div className=\"control buttons has-addons\">\n                        <a  className={\"button is-primary \"  + (this.props.width === widthAWD ? '' : 'is-outlined')}\n                            onClick={this.props.onWidthUpdate(widthAWD)}>AWD</a>\n                        <a className={\"button is-success \"  + (this.props.width === widthEPR ? '' : 'is-outlined')}\n                            onClick={this.props.onWidthUpdate(widthEPR)}>EPR</a>\n                        <a  className={\"button is-link \" + (this.props.width === widthOPR ? '' : 'is-outlined')}\n                            onClick={this.props.onWidthUpdate(widthOPR)}>OPR</a>\n                    </div>\n\n                </div>\n\n                <a  className={\"control button is-dark\" + (this.props.enableOptim ? '' : \"is-outlined\")}\n                    onClick={this.props.onOptimChange} id=\"enableOptim\">Auto-Space</a>\n            </div>\n        );\n    }\n}\n// normalize spaces\nclass InputTools extends React.PureComponent {\n\n    render() {\n        return (\n            <button className=\"button\" onClick={this.props.onTextNorm}>Renormalize Input Spacing</button>\n        );\n    }\n}\n// saving settings\nclass SaveTools extends React.PureComponent {\n    constructor(props) {\n        super(props);\n        this.exportRef = React.createRef();\n        this.state = { hovering: false };\n    }\n    onSave = () => {\n        const settings = this.props.onSave();\n        //JSON stringifying an array for future growth\n        const storedData = JSON.stringify([settings]);\n        try {\n            localStorage.setItem('bullet-settings', storedData);\n            console.log(\"saved settings/data to local storage with character length \" + storedData.length);\n        } catch (err) {\n            if (err.name === 'SecurityError') {\n                alert(\"Sorry, saving to cookies does not work using the file:// interface and/or your browser's privacy settings\")\n            } else {\n                throw err;\n            }\n        }\n    }\n    onExport = () => {\n        const settings = this.props.onSave();\n        //JSON stringifying an array for future growth\n        const storedData = JSON.stringify([settings]);\n        const dataURI = 'data:application/JSON;charset=utf-8,' + encodeURIComponent(storedData);\n        this.exportRef.current.href = dataURI;\n        this.exportRef.current.click();\n        console.log(\"exported settings/data to JSON file with character length \" + storedData.length);\n\n    }\n    hoverOut = () => {\n        this.setState({ hovering: false });\n    }\n    toggleMenu = () => {\n        const current = this.state.hovering;\n        this.setState({ hovering: !current });\n    }\n    render() {\n        const menuState = this.state.hovering ? \"is-active\" : \"\";\n        return (\n            <div className={'dropdown ' + menuState}>\n                <div className=\"dropdown-trigger\">\n                    <div className=\"buttons has-addons\">\n                        <button className=\"button\" onClick={this.onSave}>Save </button>\n                        <button className=\"button\" aria-haspopup=\"true\" aria-controls=\"save-menu\" >\n                            <span className=\"icon\" onClick={this.toggleMenu} >\n                                <FontAwesomeIcon icon={faAngleDown} />\n                            </span>\n                        </button>\n                    </div>\n                </div>\n                <div className=\"dropdown-menu\" id=\"save-menu\" role=\"menu\" onMouseLeave={this.hoverOut}>\n                    <div className=\"dropdown-content\">\n                        <a href=\"?#\" className=\"dropdown-item\" onClick={this.onSave}>Cookie</a>\n                        <a href=\"?#\" className=\"dropdown-item\" onClick={this.onExport}>JSON</a>\n                    </div>\n                </div>\n\n                <a href=\"?#\" style={{ display: \"none\" }} download='settings.json' ref={this.exportRef}></a>\n            </div>\n        );\n    }\n}\nclass Logo extends React.PureComponent {\n    render() {\n        return (\n            <h1 className='title'><span className=\"logo\">AF </span>\n                <span className=\"logo\">Bull</span>et\n                <span className=\"logo\"> Sh</span>aping &amp;\n                <span className=\"logo\"> i</span>teration\n                <span className=\"logo\"> t</span>ool\n            </h1>\n        );\n    }\n}\nclass ThesaurusTools extends React.PureComponent {\n    render() {\n        return (\n            <a  className=\"button\" onClick={this.props.onHide} aria-haspopup=\"true\" aria-controls=\"thesaurus-menu\" >\n                <span>Thesaurus</span><span className=\"icon\"  >\n                    <FontAwesomeIcon icon={faAngleDown} />\n                </span>\n            </a>\n        );\n    }\n}\nclass DocumentTools extends React.PureComponent {\n    render() {\n        return (\n            <nav className=\"navbar\" role=\"navigation\" aria-label=\"main navigation\">\n                <div className=\"navbar-start\">\n                    <div className=\"navbar-item\">\n                        <SaveTools onSave={this.props.onSave} />\n                    </div>\n                    <div className=\"navbar-item\">\n                        <ImportTools onJSONImport={this.props.onJSONImport} onTextUpdate={this.props.onTextUpdate} onWidthUpdate={this.props.onWidthUpdate} />\n                    </div>\n                    <div className=\"navbar-item\">\n                        <OutputTools\n                            enableOptim={this.props.enableOptim} onOptimChange={this.props.onOptimChange}\n                            width={this.props.width} onWidthChange={this.props.onWidthChange}\n                            onWidthUpdate={this.props.onWidthUpdate} />\n                    </div>\n                    <div className=\"navbar-item\">\n                        <InputTools onTextNorm={this.props.onTextNorm} />\n                    </div>\n                    <div className=\"navbar-item\">\n                        <ThesaurusTools onHide={this.props.onThesaurusHide} />\n                    </div>\n                </div>\n            </nav>\n        );\n    }\n}\n\n// could not do a static class property because of MS edge\nconst Forms = {\n    all: {\n        'AF707': {\n            'fields': ['S2DutyTitleDesc', 'S4Assessment', 'S5Assessment', 'S6Assessment'],\n            'likelyWidth': '201.041mm'\n        },\n        'AF1206': {\n            'fields': ['specificAccomplishments', 'p2SpecificAccomplishments'],\n            'likelyWidth': '202.321mm'\n        },\n        'AF910': {\n            'fields': ['KeyDuties', 'IIIComments', 'IVComments', 'VComments', 'VIIIComments', 'IXComments'],\n            'likelyWidth': '202.321mm'\n        },\n        'AF911': {\n            'fields': ['KeyDuties', 'IIIComments', 'IVComments', 'VIIComments', 'VIIIComments', 'IXComments'],\n            'likelyWidth': '202.321mm'\n        },\n    }\n};\nfunction getBulletsFromPdf(filedata) {\n\n\n    const pdfSetup = filedata.arrayBuffer().then(function (buffer) {\n        const uint8Array = new Uint8Array(buffer);\n\n        return pdfjs.getDocument({ data: uint8Array }).promise;\n\n    });\n\n    const getXFA = pdfSetup.then(function (pdf) {\n        return pdf.getXFA();\n    });\n\n    const getFormName = pdfSetup.then(function (pdf) {\n        return pdf.getMetadata().then(function (result) {\n            const prefix = result.info.Custom[\"Short Title - Prefix\"];\n            const num = result.info.Custom[\"Short Title - Number\"];\n            return prefix + '' + num;\n        })\n    });\n    const getAllData = Promise.all([getFormName, getXFA]);\n    const pullBullets = getAllData.then(function (results) {\n\n        const formName = results[0];\n        const xfaDict = results[1];\n\n        let datasetXML = xfaDict['datasets'];\n        datasetXML = datasetXML.replace(/&#xD;/g, '\\n');\n\n        const parser = new DOMParser();\n        const xmlDoc = parser.parseFromString(datasetXML, \"text/xml\");\n\n        let bulletText = '';\n        for (let tagName of Forms.all[formName]['fields']) {\n            const bulletTag = xmlDoc.querySelector(tagName);\n            bulletText += bulletTag.innerHTML + '\\n';\n        }\n        return bulletText;\n    });\n\n    const getPageInfo = getAllData.then(function (results) {\n\n        const formName = results[0];\n        const xfaDict = results[1];\n\n        const templateXML = xfaDict['template'];\n        const parser = new DOMParser();\n        const xmlDoc = parser.parseFromString(templateXML, \"text/xml\");\n\n        let fonts = [];\n        let fontSizes = []\n        let widths = [];\n        let i = 0;\n        for (let tagName of Forms.all[formName]['fields']) {\n            const bulletTag = xmlDoc.querySelector(\"field[name='\" + tagName + \"'\");\n            fonts[i] = bulletTag.querySelector('font').getAttribute('typeface');\n            fontSizes[i] = bulletTag.querySelector('font').getAttribute('size');\n            widths[i] = bulletTag.getAttribute('w');\n            i += 1;\n        }\n        for (let font of fonts) {\n            if (font !== fonts[0]) {\n                console.log('warning: not all grabbed sections have the same font type');\n                break;\n            }\n        }\n        for (let fontSize of fontSizes) {\n            if (fontSize !== fontSizes[0]) {\n                console.log('warning: not all grabbed sections have the same font size');\n                break;\n            }\n        }\n        for (let width of widths) {\n            if (width !== widths[0]) {\n                console.log('warning: not all grabbed sections have the same width');\n                break;\n            }\n        }\n\n        return { 'font': fonts[0], 'fontSize': fontSizes[0], 'width': widths[0] }\n\n        //accomplishmentsTag = templateXML.match(/name=\"specificAccomplishments\"(.*?)<\\/field/);\n        //console.log(accomplishmentsTag)\n    });\n    return { pullBullets, getPageInfo };\n}\n\nfunction getSelectionInfo(editorState) {\n    // this block of code gets the selected text from the editor.\n    const selectionState = editorState.getSelection();\n    const anchorKey = selectionState.getAnchorKey();\n    const contentBlock = editorState.getCurrentContent().getBlockForKey(anchorKey);\n    const start = selectionState.getStartOffset();\n    const end = selectionState.getEndOffset();\n    const selectedText = contentBlock.getText().slice(start, end);\n    return {\n        selectionState,\n        anchorKey,\n        contentBlock,\n        start,\n        end,\n        selectedText,\n    }\n}\n\nconst findWithRegex = (regex, contentBlock, callback) => {\n    const text = contentBlock.getText();\n    let matchArr, start, end;\n    while ((matchArr = regex.exec(text)) !== null) {\n        start = matchArr.index;\n        end = start + matchArr[0].length;\n        callback(start, end);\n    }\n};\n\n\n// all widths in this function are in pixels\nfunction renderBulletText(text, getWidth, width) {\n    // this function expects a single line of text with no line breaks.\n    if(text.match('\\n')){\n        console.error('renderBulletText expects a single line of text');\n    }\n    \n    const fullWidth = getWidth(text.trimEnd());\n\n    if (fullWidth < width) {\n        return {\n            textLines: [text],\n            fullWidth: fullWidth,\n            lines: 1,\n            overflow: fullWidth - width,\n        };\n    } else {\n        // Scenario where the width of the text is wider than desired.\n        //  In this case, work needs to be done to figure out where the line breaks should be. \n\n        // Regex- split after one of the following: \\s ? / | - % ! \n        // but ONLY if immediately followed by: [a-zA-z] [0-9] + \\\n        const textSplit = text.split(/(?<=[\\s?/|\\-%!])(?=[a-zA-Z0-9+\\\\])/);\n\n        // check to make sure the first token is smaller than the desired width.\n        //   This is usually true, unless the desired width is abnormally small, or the \n        //   input text is one really long word\n        if (getWidth(textSplit[0]) < width) {\n            let answerIdx = 0;\n            for (let i = 1; i <= textSplit.length; i++) {\n                const evalText = textSplit.slice(0, i).join('').trimEnd();\n                const evalWidth = getWidth(evalText);\n                if (evalWidth > width) {\n                    answerIdx = i - 1;\n                    break;\n                }\n            }\n            const recursedText = textSplit.slice(answerIdx, textSplit.length).join('');\n\n            if (recursedText === text) {\n                console.warn(\"Can't fit \\\"\" + text + \"\\\" on a single line\\n\", {text, width, fullWidth});\n                return {\n                    textLines: [text],\n                    fullWidth,\n                    lines: 1,\n                    overflow: fullWidth - width,\n                };\n            } else {\n                const recursedResult = renderBulletText(recursedText, getWidth, width);\n\n                return {\n                    textLines: [textSplit.slice(0, answerIdx).join(''), ...recursedResult.textLines],\n                    fullWidth: fullWidth,\n                    lines: 1 + recursedResult.lines,\n                    overflow: fullWidth - width,\n                }\n            }\n\n        } else {\n\n            const avgCharWidth = fullWidth / (text.length);\n            const guessIndex = parseInt(width / avgCharWidth);\n            const firstGuessWidth = getWidth(text.substring(0, guessIndex))\n            let answerIdx = guessIndex;\n            if (firstGuessWidth > width) {\n                for (let i = guessIndex - 1; i > 0; i--) {\n                    const nextGuessWidth = getWidth(text.substring(0, i));\n                    if (nextGuessWidth < width) {\n                        answerIdx = i;\n                        break;\n                    }\n                }\n            } else if (firstGuessWidth < width) {\n                for (let i = guessIndex; i <= text.length; i++) {\n\n                    const nextGuessWidth = getWidth(text.substring(0, i));\n                    if (nextGuessWidth > width) {\n                        answerIdx = i - 1;\n                        break;\n                    }\n                }\n            }\n            const recursedText = text.substring(answerIdx, text.length);\n            if (recursedText === text) {\n                console.warn(\"Can't fit \\\"\" + text + \"\\\" on a single line\\n\", {text, width, fullWidth});\n                return {\n                    textLines: [text],\n                    fullWidth,\n                    lines: 1,\n                    overflow: fullWidth - width\n                };\n            } else {\n                const recursedResult = renderBulletText(recursedText, getWidth, width);\n\n                return {\n                    textLines: [text.substring(0, answerIdx), ...recursedResult.textLines],\n                    fullWidth: fullWidth,\n                    lines: 1 + recursedResult.lines,\n                    overflow: fullWidth - width,\n                }\n            }\n        }\n    }\n}\n\n\n\nexport { Logo, DocumentTools, getSelectionInfo, findWithRegex, renderBulletText };","import React from \"react\"\nimport { Editor,  RichUtils } from \"draft-js\"\nimport \"draft-js/dist/Draft.css\";\nimport { getSelectionInfo, renderBulletText } from './tools.js'\nconst DPI = 96;\nconst MM_PER_IN = 25.4;\nconst DPMM = DPI / MM_PER_IN;\n\n\n// optimization status codes\n// status codes for optimization direction \n// had to move this to a floating object because MS Edge doesn't support static variables\nconst BULLET = {\n    OPTIMIZED: 0,\n    FAILED_OPT: 1,\n    NOT_OPT: -1,\n    ADD_SPACE: 1,\n    REM_SPACE: -1,\n    MAX_UNDERFLOW: -4,\n    Tokenize: (sentence) => {\n        return sentence.split(/[\\s]+/);\n    },\n}\n\n\nfunction BulletComparator({editorState, setEditorState, width, onSelect, abbrReplacer, enableOptim }) {\n    \n    const bulletOutputID = \"bulletOutput\";\n    const [heightMap, setHeightMap] = React.useState(new Map());\n    // Editor callback that adds rich text editor keybinds\n    const handleKeyCommand = (command, editorState) => {\n        const newState = RichUtils.handleKeyCommand(editorState, command);\n        if (newState) {\n            setEditorState(newState);\n            return 'handled';\n        }\n        return 'not-handled';\n    }\n\n    // Editor callback that runs whenever edits or selection changes occur.\n    const onChange = (newEditorState) => {\n\n        \n\n        //const content = editorState.getCurrentContent();\n        // ordered map has a key and a block associasted with it\n        //const blockMap = content.getBlockMap();\n        /*\n        for(let [key,block] of blockMap){\n            console.log(block.getText());\n        }\n        */\n        const { selectedText } = getSelectionInfo(newEditorState)\n        if (onSelect && selectedText !== '') onSelect(selectedText);\n        \n        setEditorState(newEditorState);\n    }\n\n    // This other bullet selection is for when things are selected on the optimized output\n    const onBulletSelect = (event) => {\n        const selection = window.getSelection().toString();\n        if (selection !== \"\") {\n            onSelect(selection)\n        }\n    }\n\n    // control-a selectability on bullet outputs\n    function selectOutput(e) {\n        if (e.ctrlKey && e.keyCode === 65) {\n            e.preventDefault();\n            //console.log('control-a')\n            //console.log(this.outputRef.current)\n            if (e.target.id.match(new RegExp(bulletOutputID))) {\n                const range = document.createRange();\n                range.selectNode(e.target);\n                window.getSelection().removeAllRanges();\n                window.getSelection().addRange(range);\n            }\n        }\n    }\n\n    React.useEffect(()=>{\n        let newHeightMap = new Map();\n        for(let key of editorState.getCurrentContent().getBlockMap().keys()){\n            const blockDiv = document.querySelector(`div[data-offset-key=\"${key}-0-0\"]`);\n            if(blockDiv) newHeightMap.set(key, blockDiv.getBoundingClientRect().height);\n        };\n        setHeightMap(newHeightMap);\n    },[editorState])\n\n    return (\n        <div className=\"bullets columns is-multiline\" >\n            <div className=\"column\" style={{\n                // width: width + 'mm',\n            }}>\n                <h2 className='subtitle'>Input Bullets Here:</h2>\n                <div className=\"border\" style={{ width: (width+1) + 'mm'}}>\n                    <Editor \n                        editorState={editorState} onChange={onChange} handleKeyCommand={handleKeyCommand} />\n                </div>\n            </div>\n            <div className=\"column\" >\n                <h2 className='subtitle'>View Output Here:</h2>\n                <div className=\"border\" id={bulletOutputID} style={{ width: (width+1) + 'mm' }}\n                    onMouseUp={onBulletSelect} onKeyDown={selectOutput} tabIndex=\"0\">\n                    {Array.from(editorState.getCurrentContent().getBlockMap(), ([key, block]) => {\n                        let text = block.getText();\n                        if (abbrReplacer) text = abbrReplacer(text);\n                        \n                        return <Bullet key={key} text={text} widthPx={width * DPMM} height={heightMap.get(key)} \n                            enableOptim={enableOptim} />\n                    })}\n                </div>\n            </div>\n        </div>);\n}\n/*\n            <div>\n                {editorState.getCurrentContent().getBlocksAsArray().map((block, key)=>{\n                    return <Bullet text={block.getText()} width={202.321*DPMM}/>\n                })}\n            </div>\n\n*/\n\n\n\nfunction Bullet({ text=\"\", widthPx=500, enableOptim=false, height, onHighlight }) {\n    const canvasRef = React.useRef(null);\n    const [outputTextLines, setOutputTextLines] = React.useState(() => [' ']);\n\n    const [color, setColor] = React.useState('inherit');\n    const [loading, setLoading] = React.useState(false);\n    const [optimStatus, setOptimStatus] = React.useState(BULLET.NOT_OPT);\n    const [rendering, setBulletRendering] = React.useState({ textLines: [''] });\n\n    function getTextWidth(txt, canvas){\n        const context = canvas.getContext('2d');\n        context.font = '12pt Times New Roman';\n        context.textAlign = 'left';\n        return (context.measureText(txt).width);\n     }\n\n    // This effect updates the text rendering (i.e. enforces width constraints by inserting newlines)\n    //   whenever the props text input is updated.\n    React.useEffect(() => {\n        \n        setBulletRendering(renderBulletText(text, (txt) => getTextWidth(txt,canvasRef.current), widthPx));\n\n    }, [text, widthPx, enableOptim]);\n    // [] indicates that this happens once after the component mounts.\n    // [text] indicates that this happens every time the text changes from the user (from props)\n\n    // This effect happens after bullet rendering changes. It evaluates the rendered bullet and\n    //  sees how it can be improved with modified spaces. \n    React.useEffect(() => {\n\n        setLoading(true);\n        setOutputTextLines(rendering.textLines);\n        if (enableOptim) {\n            const optimizer = (txt) => renderBulletText(txt, (txt) => getTextWidth(txt, canvasRef.current), widthPx);\n            const optimResults = optimize(text, optimizer);\n            setLoading(false);\n            setOptimStatus(optimResults.status);\n            setOutputTextLines(optimResults.rendering.textLines);\n            \n        } else {\n            if(rendering.overflow < BULLET.MAX_UNDERFLOW || rendering.overflow > 0){\n                setOptimStatus(BULLET.FAILED_OPT);\n            }else{\n                setOptimStatus(BULLET.OPTIMIZED)\n            }\n            setOutputTextLines(rendering.textLines);\n            setLoading(false);\n        }\n\n    }, [rendering, enableOptim, text, widthPx]);\n\n    //color effect\n    React.useEffect(() => {\n        if (loading) {\n            setColor(\"silver\")\n        } else if (optimStatus === BULLET.FAILED_OPT) {\n            setColor(\"red\");\n        } else {\n            setColor(\"black\");\n        }\n    }, [loading, outputTextLines, optimStatus])\n\n    // the style properties help lock the canvas in the same spot and make it essentially invisible.\n    //whitespace: pre-wrap is essential as it allows javascript string line breaks to appear properly.\n    return (\n        <>\n            <canvas\n                ref={canvasRef}\n                style={{\n                    visibility: \"hidden\",\n                    position: \"absolute\",\n                    top: \"-1000px\",\n                    left: \"-1000px\"\n                }} />\n            <div style={{\n                minHeight: height,\n                color: color,\n                display:'flex',\n                flexDirection:'column',\n            }} onMouseUp={onHighlight} >\n                {outputTextLines.map((line)=>{\n                    return <span key={line} style={{whiteSpace:\"pre\"}}>{line}</span>;\n                })}\n            </div>\n        </>\n    );\n    //return canvas;\n}\n\n\nfunction optimize(sentence, evalFcn) {\n\n    const smallerSpace = \"\\u2006\";\n    const largerSpace = \"\\u2004\";\n\n    //initialization of optimized words array\n    let optWords = BULLET.Tokenize(sentence);\n\n    const initResults = evalFcn(sentence);\n\n    if (initResults.overflow === 0) {\n        return initResults;\n    }\n\n    //initial instantiation of previousResults\n    let prevResults = initResults;\n    let finalResults = initResults;\n    const newSpace = (initResults.overflow >= 0) ? smallerSpace : largerSpace;\n\n    let finalOptimStatus = BULLET.NOT_OPT;\n\n    function hashCode (str) {\n        let hash = 0, i, chr;\n        if (str.length === 0) return hash;\n        for (i = 0; i < str.length; i++) {\n          chr = str.charCodeAt(i);\n          hash = ((hash << 5) - hash) + chr;\n          hash |= 0; // Convert to 32bit integer\n        }\n        return hash;\n      };\n\n    function getRandomInt(seed, max) {\n        return Math.floor(Math.abs((Math.floor(9 * hashCode(seed) + 5) % 100000) / 100000) * Math.floor(max));\n    }\n\n    \n    const worstCaseResults = evalFcn(optWords.join(newSpace));\n\n    if( (newSpace === smallerSpace && worstCaseResults.overflow > 0) || \n            (newSpace === largerSpace && worstCaseResults.overflow < BULLET.MAX_UNDERFLOW) ){\n            // this means that there is no point in trying to optimize.\n            \n            return {\n                status: BULLET.FAILED_OPT,\n                rendering: worstCaseResults,\n            };\n        \n    }\n\n    while (finalResults.overflow > 0 || finalResults.overflow < BULLET.MAX_UNDERFLOW) {\n        //don't select the first space after the dash- that would be noticeable and look wierd.\n        // also don't select the last word, don't want to add a space after that.\n        let iReplace = getRandomInt(optWords.join(''), optWords.length - 1 - 1) + 1;\n\n        //merges two elements together, joined by the space\n        optWords.splice(\n            iReplace, 2,\n            optWords.slice(iReplace, iReplace + 2).join(newSpace)\n        );\n\n        //make all other spaces the normal space size\n        let newSentence = optWords.join(' ');\n\n        let newResults = evalFcn(newSentence);\n\n        if (initResults.overflow <= 0 && newResults.overflow > 0) {\n            //console.log(\"Note: Can't add more spaces without overflow, reverting to previous\" );\n            finalResults = prevResults;\n            finalOptimStatus = BULLET.OPTIMIZED;\n            break;\n        } else if (initResults.overflow > 0 && newResults.overflow < 0) {\n            //console.log(\"Removed enough spaces. Terminating.\" );\n            finalResults = newResults;\n            finalOptimStatus = BULLET.OPTIMIZED;\n            break;\n        } else if (optWords.length <= 2) { //this conditional needs to be last\n            //console.log(\"\\tWarning: Can't replace any more spaces\");\n            finalResults = newResults;\n            finalOptimStatus = BULLET.FAILED_OPT;\n            break;\n        }\n        prevResults = newResults;\n    }\n    return {\n        status: finalOptimStatus,\n        rendering: finalResults,\n    };\n}\n\n\nexport { Bullet, BULLET, BulletComparator };","export default __webpack_public_path__ + \"static/media/abbrs.ebd0e99b.xlsx\";","import React from 'react'\nimport { useTable } from 'react-table'\nimport {\n    useGlobalFilter,\n    useFilters,\n    useSortBy,\n    useAsyncDebounce,\n    useRowSelect\n} from 'react-table/dist/react-table.development';\nimport update from 'immutability-helper'\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faCopy, faTrash, faCheckSquare } from \"@fortawesome/free-solid-svg-icons\"\nimport { faSquare } from \"@fortawesome/free-regular-svg-icons\"\n\n// Define a default UI for filtering\nfunction GlobalFilter({\n    preGlobalFilteredRows,\n    globalFilter,\n    setGlobalFilter,\n}) {\n    const count = preGlobalFilteredRows.length\n    const [value, setValue] = React.useState(globalFilter)\n    const onChange = useAsyncDebounce(value => {\n        setGlobalFilter(value || undefined)\n    }, 200)\n\n    return (\n        <span>\n            Search:{' '}\n            <input className=\"input\"\n                value={value || \"\"}\n                onChange={e => {\n                    setValue(e.target.value);\n                    onChange(e.target.value);\n                }}\n                placeholder={`${count} rows...`}\n                style={{\n                    fontSize: '1.1rem',\n                    border: '0',\n                }}\n            />\n        </span>\n    )\n}\n\n// Define a default UI for filtering\nfunction DefaultColumnFilter({\n    column: { filterValue, setFilter },\n}) {\n\n    return (\n        <input className=\"input\"\n            value={filterValue || ''}\n            onChange={e => {\n                setFilter(e.target.value || undefined) // Set undefined to remove the filter entirely\n            }}\n            placeholder={`Search...`}\n        />\n    )\n}\n\n// This is a custom filter UI for selecting\n// a unique option from a list\nfunction BooleanFilter({\n    column: { filterValue, setFilter },\n}) {\n    // Calculate the options for filtering\n    // using the preFilteredRows\n\n    const options = React.useMemo(() => (['All', 'Enabled', 'Disabled']), []);\n    const values = React.useMemo(() => ([undefined, true, false]), []);\n\n    const currentSelection = options[values.indexOf(filterValue)]\n\n    // Render a multi-select box\n    return (\n        <div className=\"select\">\n            <select\n                value={currentSelection}\n                onChange={e => {\n                    setFilter(values[options.indexOf(e.target.value)])\n                }}\n            >\n                {options.map((text, i) => (\n                    <option key={i} value={text}>\n                        {text}\n                    </option>\n                ))}\n            </select>\n        </div>\n    )\n}\n\n\nconst SelectCheckbox = ({\n    value,\n    row,\n    column: { id },\n    updateDataAfterInput,\n}) => {\n    // We need to keep and update the state of the cell normally\n    \n    const {onChange: onSelChange, style, indeterminate, ...rowSelectProps} = \n        React.useMemo(()=>row.getToggleRowSelectedProps(),[row]);\n    \n    const onChange = React.useCallback((e) => {\n        updateDataAfterInput(row.index, id, e.target.checked);\n        onSelChange(e);\n    },[onSelChange, id, row.index, updateDataAfterInput])\n    \n    const mergedStyle = update(style, {'$merge': {display:\"none\"}})\n    return (\n        <div style={{textAlign: \"center\"}}>\n        <label className=\"icon is-large\">\n            <input type=\"checkbox\" onChange={onChange} style={mergedStyle} {...rowSelectProps} />\n            <FontAwesomeIcon size=\"2x\" icon={value? faCheckSquare : faSquare} />\n        </label>\n        </div>\n    )\n};\n\n// Create an editable cell renderer\nconst EditableCellTemplate = ({\n    value: initialValue,\n    row: { index },\n    column: { id },\n    updateDataAfterInput,  // This is a custom function that we supplied to our table instance\n},\n    type = 'text') => {\n    // We need to keep and update the state of the cell normally\n    const [value, setValue] = React.useState(initialValue)\n\n    const onChange = e => {\n        if (type === 'checkbox') {\n            setValue(e.target.checked);\n        } else {\n            setValue(e.target.value);\n        }\n    }\n\n    // We'll only update the external data when the input is blurred\n    const onBlur = () => {\n        updateDataAfterInput(index, id, value)\n    }\n\n    // If the initialValue is changed external, sync it up with our state\n    React.useEffect(() => {\n        setValue(initialValue)\n    }, [initialValue])\n\n\n    return <input className=\"input\" type={type} value={value} onChange={onChange} onBlur={onBlur} />;\n\n}\n\n\n\nfunction AbbrTable({ data, setData }) {\n\n    // mapping of raw data columns to something meaningful\n    const columns = React.useMemo(() => [\n        {\n            Header: \"Status\",\n            accessor: 'enabled',\n            Cell: SelectCheckbox,\n            Filter: BooleanFilter,\n            filter: 'boolean',\n            disableSortBy: true,\n        },\n        {\n            Header: \"Word\",\n            accessor: 'value',\n            Cell: EditableCellTemplate,\n        },\n        {\n            Header: 'Abbreviation',\n            accessor: 'abbr',\n            Cell: EditableCellTemplate,\n        },\n    ], []);\n\n    // When our cell renderer calls updateDataAfterInput, we'll use\n    // the rowIndex, columnId and new value to update the\n    // original data\n    const updateDataAfterInput = (rowIndex, columnId, value) => {\n        setData(oldData=>{\n            const newData =  update(oldData, {\n               [rowIndex]: {\n                   [columnId]: {$set: value}}\n            });\n            return newData;  \n        });\n    }\n\n\n    const filterTypes = React.useMemo(\n        () => ({\n            // boolean filter\n            boolean: (rows, id, filterValue) => {\n                return rows.filter(row => {\n                    const rowValue = row.values[id]\n                    return rowValue !== undefined\n                        ? (rowValue === filterValue) : true\n                })\n            },\n        }),\n        []\n    )\n\n\n    const defaultColumn = React.useMemo(\n        () => ({\n            // Let's set up our default Filter UI\n            Filter: DefaultColumnFilter,\n        }),\n        []\n    )\n\n    const appendRow = (beforeIndex) => {\n        const beforeRecord = data[beforeIndex];\n        setData(\n            update(data, {\n                $splice: [\n                    [beforeIndex + 1, 0, beforeRecord]\n                ]\n            })\n        );\n    };\n\n    const deleteRow = (beforeIndex) => {\n        setData(\n            update(data, {\n                $splice: [\n                    [beforeIndex, 1]\n                ]\n            })\n        );\n    };\n\n    // note that columns and data must be memoized !\n    const tableInstance = useTable(\n        {\n            columns,\n            data,\n            defaultColumn,\n            filterTypes,\n            updateDataAfterInput,\n            autoResetSelectedRows: false,\n            manualRowSelectedKey: 'enabled',\n\n        },\n        useFilters,\n        useGlobalFilter,\n        useSortBy,\n        useRowSelect,\n    );\n\n    const {\n        getTableProps,\n        getTableBodyProps,\n        headerGroups,\n        rows,\n        prepareRow,\n        visibleColumns,\n        state,\n        setGlobalFilter,\n        preGlobalFilteredRows,\n    } = tableInstance;\n\n    return (\n        <table className=\"table is-hoverable\" {...getTableProps()}>\n            <thead>\n                <tr>\n                    <th\n                        colSpan={visibleColumns.length}\n                        style={{\n                            textAlign: 'left',\n                        }}\n                    >\n                        <GlobalFilter\n                            preGlobalFilteredRows={preGlobalFilteredRows}\n                            globalFilter={state.globalFilter}\n                            setGlobalFilter={setGlobalFilter}\n                        />\n                    </th>\n                </tr>\n                {headerGroups.map(headerGroup => {\n                    return (\n                        <tr {...headerGroup.getHeaderGroupProps()}>\n\n                            {headerGroup.headers.map(column => {\n                                // taking the default header props, then adding in toggle props. can keep chaining if wanted.\n                                return (\n                                    <th {...column.getHeaderProps()}>\n                                        <div {...column.getSortByToggleProps()}> {column.render('Header')}<span>{column.isSorted ? (column.isSortedDesc ? ' v' : ' ^') : ''}</span> </div>\n                                        <div>{column.canFilter ? column.render('Filter') : null}</div>\n                                    </th>);\n                            })}\n                            {/*this empty th is for the add delete stuff*/}\n                            <th></th><th></th>\n                        </tr>\n                    )\n                })}\n            </thead>\n            <tbody {...getTableBodyProps()}>\n                {rows.map(\n                    (row, index) =>\n                        prepareRow(row) || (\n                            <Row\n                                index={index}\n                                row={row}\n                                rowOps={{ appendRow, deleteRow }}\n                                {...row.getRowProps()}\n                            />\n                        )\n                )}\n            </tbody>\n        </table>\n    );\n}\n\n\nconst Row = ({ row, index, rowOps }) => {\n\n    return (\n        <tr>\n\n            {row.cells.map(cell => {\n                return <td {...cell.getCellProps()}>{cell.render('Cell')}</td>\n            })}\n            <td>\n                <a className=\"icon is-large\" onClick={() => rowOps.appendRow(index)}>\n                    <FontAwesomeIcon icon={faCopy} size=\"2x\" />\n                </a>\n                <a className=\"icon is-large\" onClick={() => rowOps.deleteRow(index)}>\n                    <FontAwesomeIcon icon={faTrash} size=\"2x\"/>\n                </a>\n            </td>\n        </tr>\n    )\n}\n\nexport default AbbrTable;","//import React from 'react';\n//import ReactDOM from 'react-dom';\n//import { HotTable } from '@handsontable/react';\n//import Handsontable from 'handsontable';\n\nimport React from \"react\"\nimport XLSX from \"xlsx\"\nimport SampleAbbrFile from '../static/abbrs.xlsx'\nimport AbbrTable from './abbrtable.js'\n\n\nfunction AbbrTools({ data, setData, ...props}) {\n\n    const fileInputRef = React.createRef();\n    function importSampleAbbrs() {\n        return new Promise((res) => {\n            const xhttp = new XMLHttpRequest();\n            xhttp.responseType = 'blob';\n            xhttp.onload = () => {\n                res(xhttp.response);\n            }\n            xhttp.open('GET', SampleAbbrFile, true);\n            xhttp.send();\n        }).then(getDataFromXLS);\n    }\n    function importAbbrs(e) {\n\n        if (!fileInputRef.current.value) {\n            console.log('no file picked');\n            return;\n        } else {\n            getDataFromXLS(fileInputRef.current.files[0]);\n            fileInputRef.current.value = '';\n        }\n\n    }\n    function getDataFromXLS(file) {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n            const data = e.target.result;\n            const workbook = XLSX.read(data, {\n                type: 'binary',\n                raw: true,\n            });\n            const rows = XLSX.utils.sheet_to_json(\n                workbook.Sheets[workbook.SheetNames[0]],\n                { 'header': ['enabled', 'value', 'abbr'] })\n                .map(({enabled, value, abbr})=>{\n                        return {enabled, value, abbr}\n                });\n            \n            // checks first row, enabled value and see if it matches header text\n            // normally enabled is a boolean.\n            if((rows[0].enabled.toString()).match(/enabled/i)){\n                setData(rows.slice(1));\n            } else{\n                setData(rows);\n            }\n            \n        };\n        reader.readAsBinaryString(file)\n    }\n    function exportToXLS() {\n        const wb = XLSX.utils.book_new();\n        const sht = XLSX.utils.json_to_sheet(data);\n        XLSX.utils.book_append_sheet(wb, sht, 'abbrs')\n        XLSX.writeFile(wb, 'abbrs.xlsx');\n    }\n    function inputClick() {\n        fileInputRef.current.click();\n    }\n\n\n    return (\n        <div className='toolbox'>\n            <input type=\"file\" onChange={importAbbrs} ref={fileInputRef} style={{ display: \"none\" }}></input>\n            <button className=\"button\" onClick={inputClick}>Import Abbrs</button>\n            <button className=\"button\" onClick={exportToXLS}>Export Abbrs</button>\n            <button className=\"button\" onClick={() => {\n                if (window.confirm(\"Are you sure you want to remove all existing acronyms and replace with a common list?\")) {\n                    importSampleAbbrs();\n                }\n            }}>Load Common Abbrs</button>\n        </div>\n    );\n\n}\n\nfunction AbbrsViewer({ data, setData }) {\n    return (\n        <div>\n            <AbbrTools setData={setData} data={data} />\n            <AbbrTable data={data} setData={setData} />\n        </div>\n    );\n}\n\nexport default AbbrsViewer;","import React from \"react\"\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons\"\n\n\nconst handleCardClick = (word, This) => {\n    return (e) => {\n        e.preventDefault();\n        This.props.onSelReplace(word);\n    }\n}\n\nclass SynonymViewer extends React.PureComponent {\n    constructor(props) {\n        super(props)\n        this.state = {\n            synonyms: [],\n            hidden: true,\n        }\n    }\n    getSynonyms = (phrase) => {\n        const xhttp = new XMLHttpRequest();\n        xhttp.onreadystatechange = () => {\n            if (xhttp.readyState === 4 && xhttp.status === 200) {\n                const dat = JSON.parse(xhttp.responseText);\n\n                if (dat.length !== 0) {\n                    this.setState({\n                        synonyms: dat.map((item) => { return item.word }),\n                    });\n                } else {\n                    this.setState({\n                        synonyms: []\n                    })\n                }\n            }\n        }\n        const maxWords = 75;\n        xhttp.open(\"GET\", \"https://api.datamuse.com/words?max=\" + maxWords + \"&ml=\" + phrase, true)\n        xhttp.send();\n    }\n    componentDidMount() {\n        this.getSynonyms(this.props.word);\n    }\n    componentDidUpdate(prevProps) {\n        if (prevProps.word !== this.props.word) {\n            this.getSynonyms(this.props.word);\n        }\n    }\n\n    render() {\n        const replacedWord = this.props.abbrReplacer(this.props.word);\n        const otherAbbrs = this.props.abbrDict[this.props.word];\n        const header =\n            <span className=\"tag is-medium\">\n                <Synonym word={this.props.word} key={this.props.word}\n                    abbr={replacedWord === this.props.word ? \"\" : replacedWord}\n                    otherAbbrs={otherAbbrs} />\n                <a className=\"icon is-small\" onMouseDown={handleCardClick(this.props.word, this)}>\n                    <FontAwesomeIcon icon={faPlus} size=\"xs\" color=\"#51cf66\" />\n                </a>\n            </span>;\n\n        const synonyms = <SynonymList onSelReplace={this.props.onSelReplace} key={this.state.synonyms.join('')} synonyms={this.state.synonyms} abbrDict={this.props.abbrDict} abbrReplacer={this.props.abbrReplacer} />;\n        const explanation = <span className=\"panel-block\" key='init'>Auto-thesaurus box - highlight a word or phrase below to show synonyms in this box</span>;\n        const noResults = <span className=\"panel-block\" key='none'>no results found</span>;\n        let mainBody;\n        if (this.props.word === '') {\n            mainBody = explanation;\n        } else if (this.state.synonyms.length === 0) {\n            mainBody = noResults;\n        } else {\n            mainBody = synonyms;\n        }\n\n        return (\n            <div className=\"card\">\n                <header className=\"card-header has-background-light\tis-shadowless\">\n                    <div className=\"card-header-title\" >\n                        <span >Thesaurus{this.props.word ? ':' : \"\"}</span>\n                        {this.props.word ? header : ''}\n                    </div>\n                    <a className=\"card-header-icon\" onClick={this.props.onHide}>\n                        <span className=\"delete\">\n                        </span>\n                    </a>\n                </header>\n                <div className=\"card-content\" style={{ height: \"290px\", overflow: \"auto\" }} >\n\n                    {mainBody}\n\n                </div>\n            </div>\n        )\n    }\n}\n\n\n\nclass SynonymList extends React.PureComponent {\n\n    handleCardClick = (word) => {\n        return (e) => {\n            e.preventDefault();\n            this.props.onSelReplace(word);\n\n        }\n    }\n    render() {\n\n        return (\n            <div>\n                <div className=\"tags are-medium \">\n                    {this.props.synonyms.map((word, i) => {\n                        const replacedWord = this.props.abbrReplacer(word);\n                        const otherAbbrs = this.props.abbrDict[word];\n                        return (\n                            <span className='tag' key={i} >\n                                <Synonym word={word}\n                                    abbr={replacedWord === word ? \"\" : replacedWord}\n                                    otherAbbrs={otherAbbrs} />\n                                <a className=\"icon\" onMouseDown={handleCardClick(word, this)}>\n                                    <FontAwesomeIcon icon={faPlus} size=\"xs\" color=\"#51cf66\" />\n                                </a>\n                            </span>\n                        )\n                    }\n                    )}\n                </div>\n            </div>\n        )\n\n    }\n}\nclass Synonym extends React.PureComponent {\n    render() {\n        //don't forget! you need to add capability to check on disabled abbreviations\n        let mainAbbrDisp = '';\n        if (this.props.abbr) {\n            mainAbbrDisp = <span style={{ fontWeight: \"bold\" }}>\n                {\" (\" + this.props.abbr + \")\"}\n            </span>;\n        }\n\n        let enabledAbbrDisp = ''\n        let disabledAbbrDisp = ''\n\n        if (this.props.otherAbbrs) {\n            if (this.props.otherAbbrs.enabled) {\n                let enabledAbbrs = this.props.otherAbbrs.enabled.filter((abbr) => {\n                    return abbr !== this.props.abbr;\n                });\n                if (enabledAbbrs.length > 0) {\n                    enabledAbbrDisp = <span style={{ fontStyle: \"italic\" }}>\n                        {\" (\" + enabledAbbrs.join(',') + \")\"}\n                    </span>\n                }\n            }\n\n            if (this.props.otherAbbrs.disabled) {\n                let disabledAbbrs = this.props.otherAbbrs.disabled;\n                if (disabledAbbrs.length > 0) {\n                    disabledAbbrDisp = <span style={{ fontStyle: \"italic\" }}>\n                        {\" (\" + disabledAbbrs.join(',') + \")\"}\n                    </span>\n                }\n            }\n        }\n        return (\n            <span>\n                <span>{this.props.word}</span>\n                {mainAbbrDisp}\n                {enabledAbbrDisp}\n                {disabledAbbrDisp}\n            </span>\n        )\n    }\n}\nexport default SynonymViewer;","import React from \"react\"\nimport { BULLET, BulletComparator } from \"./bullets.js\"\nimport { Logo, DocumentTools, getSelectionInfo, findWithRegex } from \"./tools.js\"\nimport AbbrsViewer from \"./abbrs.js\"\nimport SynonymViewer from \"./thesaurus.js\"\n// booleans for debugging\nimport { EditorState, ContentState, Modifier, SelectionState } from \"draft-js\"\n\n\nconst defaultText = '- This is a custom built bullet writing tool; abbreviations will be replaced according to table in the abbreviations tab--you will see output on the right\\n\\\n- This tool can optimize spacing; output will be red if the optimizer could not fix spacing with 2004 or 2006 Unicode spaces\\n\\\n- Click the thesaurus button to show one; select a word in this or the output box to view synonyms--words in parentheses are abbreviations that are configured'\n\nconst defaultWidth = 202.321;\nconst defaultAbbrData = [{\n    enabled: true,\n    value: 'abbreviations',\n    abbr: 'abbrs',\n  }, {\n    enabled: true,\n    value: 'table',\n    abbr: 'tbl',\n  }, {\n    enabled: true,\n    value: 'optimize',\n    abbr: 'optim',\n  }, {\n    enabled: true,\n    value: 'with ',\n    abbr: 'w/',\n  }, {\n    enabled: true,\n    value: 'parentheses',\n    abbr: 'parens',\n  },\n  ];\n\nconst defaultEditorState = EditorState.createWithContent(ContentState.createFromText(defaultText));\n\n// Note that all width measurements in this file are in millimeters.\nfunction BulletApp() {\n\n    const [enableOptim, setEnableOptim] = React.useState(true);\n    const [width, setWidth] = React.useState(defaultWidth);\n    const [abbrData, setAbbrData] = React.useState(defaultAbbrData);\n\n    const [abbrDict, setAbbrDict] = React.useState({});\n\n    const [selection, setSelection] = React.useState('');\n    const [currentTab, setCurrentTab] = React.useState(0);\n    const [showThesaurus, setShowThesaurus] = React.useState(false);\n    const [editorState, setEditorState] = React.useState(defaultEditorState);\n\n    function handleJSONImport(settingsArray) {\n        const settings = settingsArray[0]; //preparing for possible eventual several tabs of stuff\n        setEnableOptim(settings.enableOptim ?? enableOptim);\n\n        // for backwards compatibility\n        setWidth(parseFloat(settings.width ?? width));\n        \n        // for backwards compatibility \n        if (Array.isArray(settings.abbrData[0])){\n            setAbbrData(settings.abbrData.map((row) => {\n                return {\n                    enabled: row[0],\n                    value: row[1],\n                    abbr: row[2],\n                    };\n                }));\n        }else{\n            setAbbrData(settings.abbrData ?? abbrData);\n        }\n        \n        \n\n        setEditorState(\n            settings.editorState ? EditorState.fromJS(settings.editorState) :\n                EditorState.createWithContent(ContentState.createFromText(settings.text))\n        );\n    }\n\n    React.useEffect(() => {\n\n        let settingsArray;\n        try {\n\n            if (localStorage.getItem('bullet-settings')) {\n                settingsArray = JSON.parse(localStorage.getItem(\"bullet-settings\"));\n                handleJSONImport(settingsArray);\n            }\n        } catch (err) {\n            if (err.name === 'SecurityError') {\n                console.log('Was not able to get localstorage bullets due to use of file interface and browser privacy settings');\n            } else {\n                throw err;\n            }\n        }\n\n    }, [])\n\n    React.useEffect(() => {\n        const newAbbrDict = {};\n        abbrData.forEach((row) => {\n            let fullWord = String(row.value).replace(/\\s/g, ' ');\n            let abbr = row.abbr;\n            let enabled = row.enabled;\n            newAbbrDict[fullWord] = newAbbrDict[fullWord] || []; //initializes to empty array if necessary\n\n            if (enabled) {\n                newAbbrDict[fullWord].enabled = newAbbrDict[fullWord].enabled || [];\n                newAbbrDict[fullWord].enabled.push(abbr)\n            } else {\n                newAbbrDict[fullWord].disabled = newAbbrDict[fullWord].disabled || [];\n                newAbbrDict[fullWord].disabled.push(abbr)\n            }\n        })\n\n        setAbbrDict(newAbbrDict);\n    }, [abbrData]);\n\n    const abbrReplacer = React.useCallback((sentence) => {\n\n        const finalAbbrDict = {};\n        Object.keys(abbrDict).forEach(\n            (word) => {\n                const abbrs = abbrDict[word]; //an array\n                //if there is at least one enabled abbreviation, take the lowest most element of it.\n                if (abbrs.enabled) {\n                    finalAbbrDict[word] = abbrs.enabled[abbrs.enabled.length - 1];\n                }\n            }\n        )\n\n        // courtesy of https://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex \n        function escapeRegExp(string) {\n            return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n        }\n\n        let modifiers = 'g';\n        const allApprovedAbbrs = Object.keys(finalAbbrDict).map(escapeRegExp).join('|');\n\n        // some info on the boundary parts of the regex:\n        // (^|\\\\W|\\\\b) \n        //     ^ - ensures words at the beginning of line are considered for abbreviation\n        //     \\\\W - expects abbr to be preceded by a non-word, i.e. a space, semicolon, dash, etc.\n        //     \\\\b - also check for word boundaries, this is necessary for edge cases like 'f/ ' and 'w/ '.\n        //            Otherwise things like 'with chicken' and 'for $2M' won't resolve to 'w/chicken' and 'f/$2M'.\n        // (\\\\W|\\\\b|$)\n        //     \\\\W, \\\\b - see above\n        //     $ - ensures words at end of line are considered for abbreviation\n        const regExp = new RegExp(\"(^|\\\\W|\\\\b)(\" + allApprovedAbbrs + \")(\\\\W|\\\\b|$)\", modifiers);\n        const newSentence = sentence.replace(regExp,\n            (match, p1, p2, p3) => {\n                //p2 = p2.replace(/ /g,'\\\\s')\n                let abbr = finalAbbrDict[p2];\n                if (!abbr) {\n                    abbr = '';\n                }\n                return p1 + abbr + p3;\n            }\n        );\n        return newSentence;\n    }\n        , [abbrDict])\n\n\n    function handleOptimChange() {\n        setEnableOptim(!enableOptim);\n    }\n    function handleSelect(newSel) {\n        const maxWords = 8;\n        if (newSel.trim() !== '') {\n            setSelection(BULLET.Tokenize(newSel.trim()).slice(0, maxWords).join(' '));\n        }\n\n    }\n\n    function handleWidthChange(e) {\n        setWidth(parseFloat(e.target.value))\n    }\n    function handleTextNorm() {\n\n        const selectionsToReplace = [];\n        const contentState = editorState.getCurrentContent();\n        contentState.getBlockMap().forEach((block, key) => {\n            findWithRegex(/\\s+/g, block, (anchorOffset, focusOffset) => {\n                const selection = SelectionState.createEmpty(key).merge({ anchorOffset, focusOffset });\n                selectionsToReplace.push(selection);\n            });\n        });\n\n        let newContentState = contentState;\n        // need to reverse the selections list, because otherwise as the newContentState is iteratively changed, \n        //  subsequent selections will get shifted and get all jacked up. This problem can be avoided by going backwards.\n        selectionsToReplace.reverse().forEach(selection => {\n            newContentState = Modifier.replaceText(newContentState, selection, ' ');\n        });\n\n        setEditorState(EditorState.createWithContent(newContentState));\n\n\n    }\n    function handleTextUpdate(newText) {\n        return () => setEditorState(EditorState.createWithContent(ContentState.createFromText(newText)));\n    }\n    function handleWidthUpdate(newWidth) {\n        return () => setWidth(newWidth);\n    }\n    function handleSave() {\n\n        return {\n            width: width,\n            text: editorState.getCurrentContent().getPlainText('\\n'),\n            editorState: editorState.toJS(),\n            abbrData: abbrData,\n            enableOptim: enableOptim,\n        }\n    }\n    function handleTabChange(newTab) {\n        return () => setCurrentTab(newTab);\n    }\n    function handleThesaurusHide() {\n        setShowThesaurus(!showThesaurus)\n    }\n    function handleSelReplace(word) {\n\n        if (document.activeElement.className.match(/public-DraftEditor-content/)) {\n\n            const { selectedText, start, anchorKey, selectionState } = getSelectionInfo(editorState);\n\n            const trailingSpaces = selectedText.match(/\\s*$/)[0];\n            const newEnd = start + word.length + trailingSpaces.length;\n\n            const newSelectionState = SelectionState.createEmpty(anchorKey).merge({\n                anchorOffset: start,\n                focusOffset: newEnd,\n            })\n\n            const newContent = Modifier.replaceText(editorState.getCurrentContent(), selectionState, word + trailingSpaces);\n            const newEditorState = EditorState.push(editorState, newContent, 'insert-characters');\n            const newEditorStateSelect = EditorState.forceSelection(newEditorState, newSelectionState);\n\n            setEditorState(newEditorStateSelect);\n        };\n    }\n\n    const tabs = ['Bullets', 'Abbreviations'];\n    const tabContents = [\n        <BulletComparator\n            editorState={editorState}\n            setEditorState={setEditorState}\n            abbrReplacer={abbrReplacer}\n            width={width}\n            onSelect={handleSelect} enableOptim={enableOptim} />,\n        <AbbrsViewer\n            data={abbrData}\n            setData={setAbbrData} />\n    ];\n\n    return (\n\n        <div className=\"container is-fluid\">\n            <div className='columns is-multiline'>\n                <div className='column is-full'>\n                    <Logo />\n                    <DocumentTools\n                        enableOptim={enableOptim}\n                        onOptimChange={handleOptimChange}\n                        width={width} onWidthChange={handleWidthChange}\n                        onWidthUpdate={handleWidthUpdate}\n                        onTextNorm={handleTextNorm}\n                        onTextUpdate={handleTextUpdate}\n                        onSave={handleSave}\n                        onJSONImport={handleJSONImport}\n                        onThesaurusHide={handleThesaurusHide}\n                    />\n                </div>\n\n                <div className={'column is-full ' + (showThesaurus ? \"\" : \"is-hidden\")}>\n                    <SynonymViewer word={selection} onSelReplace={handleSelReplace} abbrDict={abbrDict} abbrReplacer={abbrReplacer}\n                        onHide={handleThesaurusHide} />\n                </div>\n                <div className=\"column is-full\">\n                    <div className=\"tabs\">\n                        <ul>\n                            {tabs.map((tab, i) => {\n                                return (\n                                    <li key={i} className={currentTab === i ? \"is-active\" : ''} ><a onClick={handleTabChange(i)}>{tab}</a></li>\n                                )\n                            }\n                            )}\n                        </ul>\n                    </div>\n                </div>\n                <div className='column is-full'>\n                    {tabContents[currentTab]}\n                </div>\n            </div>\n        </div>\n\n    );\n}\n\nexport default BulletApp;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n\n//import {Bullet, BulletComparator, Skeleton} from \"./components/bullets.js\"\nimport BulletApp from \"./components/bulletapp.js\"\n\nimport \"./styles/index.scss\"\nimport 'handsontable/dist/handsontable.full.css'\n\nimport * as serviceWorker from './serviceWorker';\nimport WebFont from 'webfontloader';\n\n\n\nWebFont.load({\n  custom: {\n    families: ['AdobeTimes']\n  }\n});\n\n\n\n\nReactDOM.render(\n  <>\n    <div className=\"section\" id=\"stuff\" >\n      <BulletApp  />\n    </div>\n    <div className=\"container\" id=\"footer\">\n      <div>If you have feedback, submit\n          an <a href='https://github.com/AF-VCD/pdf-bullets/issues'>issue</a>\n          or a <a href=\"https://github.com/AF-VCD/pdf-bullets/pulls\">pull request</a>\n      </div>\n      <div>This site utilizes PDF.JS (pdf import), react-table (spreadsheet), draft-js (editor), the DataMuse API (thesaurus), and Bulma (CSS).</div>\n      <div>This site has basic analytics to track the total number of visits to the page. See <a href=\"https://github.com/ckhordiasma/log-bullet-visitors\">here</a> for details</div>\n      <div>Maintained by Christopher Kodama </div>\n    </div>\n  </>\n  , document.getElementById('root'));\n\nincrementVisitors();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n\nfunction incrementVisitors() {\n  // code for incrementing visitor count    \n  const xh = new XMLHttpRequest();\n  xh.onreadystatechange = () => {\n    if (xh.readyState === XMLHttpRequest.DONE) {\n      var status = xh.status;\n\n      // Not sure what status codes are acceptable.. using MDN successful responses and redirects range as a guide\n      if ((status >= 200 && status < 400)) {\n        // The request has been completed successfully\n        const count = JSON.parse(xh.response).Count;\n        console.log(\"The bullets site(s) have been visited \" + count + \" times in the last 7 days.\");\n\n      } else {\n        console.log(\"Visitor count increment: task failed successfully\");\n      }\n    }\n  }\n  xh.open(\"POST\", \"https://g5z50elklh.execute-api.us-east-2.amazonaws.com/default/LogVisitors\", true);\n  xh.send();\n}"],"sourceRoot":""}